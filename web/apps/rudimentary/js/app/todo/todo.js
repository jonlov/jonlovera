app.factory("todoStorage",function(){var a="todos";return{get:function(){return JSON.parse(localStorage.getItem(a)||"[]")},put:function(b){localStorage.setItem(a,JSON.stringify(b))}}}),app.controller("TodoCtrl",["$scope","$location","$filter","todoStorage",function(a,b,c,d){var e=a.todos=d.get();a.newTodo="",a.remainingCount=c("filter")(e,{completed:!1}).length,""===b.path()&&b.path("/"),a.location=b,a.$watch("location.path()",function(b){console.log(b),a.statusFilter={"/app/todo/active":{completed:!1},"/app/todo/completed":{completed:!0}}[b]}),a.$watch("remainingCount == 0",function(b){a.allChecked=b}),a.addTodo=function(){var b=a.newTodo.trim();0!==b.length&&(e.push({title:b,completed:!1}),d.put(e),a.newTodo="",a.remainingCount++)},a.editTodo=function(b){b.editedTodo=!0,a.originalTodo=angular.extend({},b)},a.doneEditing=function(b){b.editedTodo=!1,b.title=b.title.trim(),b.title||a.removeTodo(b),d.put(e)},a.revertEditing=function(b){e[e.indexOf(b)]=a.originalTodo,a.doneEditing(a.originalTodo)},a.removeTodo=function(b){a.remainingCount-=b.completed?0:1,e.splice(e.indexOf(b),1),d.put(e)},a.todoCompleted=function(b){a.remainingCount+=b.completed?-1:1,d.put(e)},a.clearCompletedTodos=function(){a.todos=e=e.filter(function(a){return!a.completed}),d.put(e)},a.markAll=function(b){e.forEach(function(a){a.completed=b}),a.remainingCount=b?0:e.length,d.put(e)}}]);